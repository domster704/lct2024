
# Решение команды «МИСИС Два миллиона»

Наша команда разработала распределенную систему для прогнозирования и формирования закупок. Основным нашим преимуществом является простота системы, скорость взаимодействия и возможности, реализованные под решение конкретных проблем бизнеса

## Основные ссылки

*данные для входа в админ-панель и в чат-бот указаны в документации к использованию сервиса*
1. [**Ссылка на админ-панель**](https://purchasing-assistant.itatmisis.ru/#)
2. [**Ссылка на чат-бота**](https://t.me/Purchasing_Assistant_bot)
3. [**Скринкаст работы сервиса**](#)

## Команда
- Исупов Григорий - FrontEnd & DevOps
- Пискунов Степан - BackEnd & DevOps
- Кадомцев Андрей - ML Developer
- Плешаков Иван - ML Developer, TeamLead
- Шубина Светлана - UI/UX Designer

## Инструкция для запуска
```
1. git clone https://github.com/ParkieV/lct2024.git && cd lct2024
2. настройка переменных окружения и конфигураций
    2.1. backend/src/.envs/app.env # пример в backend/src/.envs/app.example.env
    2.2. backend/src/.envs/auth.env # пример в backend/src/.envs/auth.example.env
    2.3. backend/src/.envs/db.env # пример в backend/src/.envs/db.example.env
    2.4. backend/src/.envs/redis.env # пример в backend/src/.envs/redis.example.env
3. docker compose up
```

## Архитектура

![Картинка архитектуры системы](/images/system_architecture.png)

### Компоненты системы

#### Чат-бот

Мы реализовали чат-бот на основе Telegram API (библиотека aiogram) в виду его популярности среди пользователей и удобстве использования. Соедниение чат-бота реализовано на основе технологии WebSocket.
Пользовательский путь в чат-боте представляет из себя ориентированный граф, где есть присутсвует понятие **История** - возможность возвращаться на предыдущие этапы путем нажатия на кнопку **Назад**

Список технологий:
- **Aiogram 3**
- **SQLAlchemy**
- **Aiosqlite**
- **Aiohttp**
- **Python 3.10**

Функционал чат-бота:
- Авторизация и деавторизация.
- Общий анализ закупок по годам/кварталам/месяцам и по цене/количеству.
- Просмотр и редактирование баланса, просмотр общей стоимости каждой и всех закупок.
- Создание, удаление закупки и ее выбор в случае, если она создана.
- Добавление в закупку товара. Стоимость, объем и даты поставок определяются сервисом автоматически, если товар регулярный.
- Матчинг товара с возможностью ввода с помощью аудио - реализация Speech2Text для этого. 
- График прогнозирования товара по годам/кварталам/месяцам.
- Анализ товара
  - Файл с последними N закупками товара. Число N пользователь вводит сам.
  - График статистики по закупкам товара по годам/кварталам/месяцам и по цене/количеству.
  - График по обороту дебет/кредит по годам/кварталам/месяцам и по цене/количеству.
  - График с остатками товара на складе.

||||
|-|-|-|
|![](https://github.com/ParkieV/lct2024/assets/61056244/4f9ab7ea-b43b-4420-b7cd-5dbf9d955666)|![](https://github.com/ParkieV/lct2024/assets/61056244/483381e0-994b-4adb-a533-3e0509ef9078)|![](https://github.com/ParkieV/lct2024/assets/61056244/877ddd42-0d58-487d-b2a9-39074f1ff169)|


#### Админ-панель

Список технологий:
- **React-JS**
- **Redux-Toolkit**
- **React-Router**
- **WebPack5**
- **Babel**
- **JavaScript**
- **HTML5**
- **CSS3**

В панели администратора доступны следующие функции:
- Создавать новых пользователей.
- Список пользователей. Сортировка, фильтрация и пагинация списка
- Просматривать информацию уже существующих пользователей.
- Редактировать информацию о существующих пользователей.
- Удаление пользователей.
*Открытой регистрации для пользователей в админ-панели нет в целях избежания утечки данных.*

![image](https://github.com/ParkieV/lct2024/assets/61056244/4d70d318-cd90-44e9-8d0b-c617f56d0a9d)
![image](https://github.com/ParkieV/lct2024/assets/61056244/c3997991-a417-4045-b095-a470d86f10be)
![image](https://github.com/ParkieV/lct2024/assets/61056244/b7332e68-78d7-4d0c-8d66-58d5da545268)



#### Основное API

Является ядром нашего решения. Данный сервис отвечает за сохранение данных пользователя, передает информацию о предсказаниях и аналитике, а также реализует систему авторизации. Он может быть использован отдельно от чат-бота, позволяя сохранить все основные возможности системы. Взаимодействие реализовано на основе протокола HTTP.

[Документация к API](https://purchasing-assistant.itatmisis.ru/api/docs)


## ML

Для решения задач, связанных с искусственным интеллектом, был разработан полноценный ML-сервис на FastAPI. Это позволяет нашему решению быстро и эффективно обрабатывать запросы, обеспечивая высокую производительность и масштабируемость. Интеграция с другими компонентами системы происходит бесшовно, что упрощает развертывание и эксплуатацию приложения.


### Используемые технологии

* **FastAPI**: для создания высокопроизводительного веб-приложения
* **Pandas** и **NumPy**: для работы с данными и аналитики
* **Matplotlib**: для создания графиков
* **Whisper**: модель для обработки голосовых запросов
* **RuBert-base** и **TheFuzz**: модели для обработки пользовательских запросов и матчинга товаров

### Возможности сервиса

* Поиск похожих товаров
* Прогнозирование закупок
* Аналитика остатков товаров
* Расшифровка голосовых запросов


[Документация к API](https://purchasing-assistant.itatmisis.ru/api_ml/docs)

## Backend
---
### Стек технологий
* **Python** - основной язык, на котором написано центральное API и телеграм-бот
* **FastAPI** - фреймворк для написания API сервисов
* **Pydantic** - валидация данных
* **SQLAlchemy** - взаимодействие с базой данных
* **PyJWT** - реализация JWT
* **Redis** - кэширование данных
* **Postgres** - основное хранилище данных
* **Asyncpg** - асинхронный драйвер для взаимодействия с PostgreSQL
* **Aiogramm** - асинхронная библиотека для написания тг-ботов
* **Aiohttp** - асинхронная библиотека для реализации API
* **Aiosqlite** - асинхронный драйвер для взаимодействия с локальным хранилищем SQLite
### Почему такой стек?
Архитектура системы - микросервисы. Это позволяет системе быть модульной, масштабируемой и иметь возможность заменить и дополнить сервисы без нарушения работы системы.

Также можно выделить простоту поддержки, высокую скорость работы. Архитектура системы упрощена засчет сокращения количества подключаемых сервисов. Система защищена от несанкционированного доступа с помощью JWT токенов используемых для взаимодействия с сервисами приложения.

